{"version":3,"sources":["components/PageFooterComponent.tsx","store/preferences/actions.ts","store/root-selectors.tsx","store/preferences/selectors.ts","store/schedule/selectors.ts","components/settings/GroupFiltersComponent.tsx","components/settings/SettingsDialogComponent.tsx","components/PageHeaderComponent.tsx","store/classes/actions.ts","store/schedule/actions.ts","utils/math-utils.ts","utils/string-uitls.ts","components/timetable/hourTimetable/HourDialogComponent.tsx","components/timetable/hourTimetable/LessonComponent.tsx","components/timetable/dayTimetable/DayTimetableComponent.tsx","components/timetable/timetableHeader/HeaderSlotComponent.tsx","components/timetable/timetableHeader/TimetableHeaderComponent.tsx","components/timetable/TimetableComponent.tsx","App.tsx","reportWebVitals.ts","store/schedule/reducer.ts","store/classes/reducer.ts","store/preferences/reducer.ts","store/root-reducer.ts","store/schedule/epics.ts","store/classes/epics.ts","store/root-epic.ts","services/schedule-api.ts","services/index.ts","store/index.ts","index.tsx"],"names":["useStyles","makeStyles","theme","footer","backgroundColor","palette","background","paper","flexShrink","footerText","paddingRight","spacing","float","PageFooterComponent","classes","className","Typography","variant","align","gutterBottom","Link","target","href","color","setTheme","createAction","setClass","addGroup","removeGroup","getFiltersForCurrentClass","state","groupFilters","class","preferencesGetFilters","preferences","getTimetableSize","schedule","flat","length","scheduleGetTimetableSize","filteredTimetable","timetable","undefined","JSON","parse","stringify","dayIdx","hourIdx","xd","filter","lesson","subject","group","find","v","scheduleFilteredTimetable","createStyles","root","width","height","overflow","listSection","ul","padding","dispatchProps","GroupFiltersComponent","memo","groups","selectedGroups","currentClass","cssClasses","handleToggle","lessonName","val","List","subheader","Object","keys","map","ListSubheader","ListItem","dense","button","onClick","ListItemIcon","Checkbox","edge","checked","tabIndex","disableRipple","ListItemText","primary","secondary","teacher","connect","minHeight","maxHeight","SettingsDialogComponent","open","onClose","useState","value","setValue","Dialog","aria-labelledby","maxWidth","fullWidth","DialogTitle","id","TabContext","TabList","indicatorColor","textColor","onChange","event","newValue","Tab","label","DialogContent","TabPanel","DialogActions","Button","getClassesMenuContent","availableClasses","classesStatus","menuItemClicked","classParam","skeletonStyle","loading","Skeleton","animation","error","cla","MenuItem","selected","toolbar","borderBottom","divider","toolbarTitle","margin","flex","breakpoints","down","fontSize","sectionDesktop","display","up","sectionMobile","withRouter","isLoadingClasses","history","cssStyleClasses","useParams","selectClassAnchorEl","setSelectClassAnchorEl","mobileMoreAnchorEl","setMobileMoreAnchorEl","settingsOpen","setSettingsOpen","selectClassOpen","Boolean","mobileOpen","handleSelectClassClick","currentTarget","handleSelectClassClose","mobileMenuId","themeIcon","themeClicked","IconButton","aria-label","getThemeIcon","feedbackIcon","Tooltip","title","arrow","component","githubIcon","settingsIcon","renderMobileMenu","Menu","anchorEl","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","Toolbar","Box","alignSelf","endIcon","PaperProps","style","push","noWrap","aria-controls","aria-haspopup","loadClassesAsync","createAsyncAction","loadScheduleAsync","createGroupsAction","gcd","x","y","lcm","an","Error","last","pop","lcm_rec","capitalizeFirstLetter","s","locale","navigator","language","charAt","toLocaleUpperCase","slice","HourDialogComponent","lessons","lessonNumber","dayIndex","currentWeekInterval","handleClose","CssBaseline","format","pl","key","classroom","Divider","lessonTile","textStyle","LessonComponent","hexcolor","lessonsByHour","useFitText","logLevel","minFontSize","ref","setOpen","dialogData","setDialogData","setLessonNumber","split","hex","join","parseInt","substr","flexDirection","e","currentTargetRect","getBoundingClientRect","clickPositionFrac","pageX","left","right","lessonDurationFrac","duration","clickedPart","Math","floor","current","Node","contains","time_index","textAlign","day_index","getProcessedHourSlots","dayTimetable","maxCongetsion","Array","fill","i","totalWidth","processedHourSlot","hourSchedule","processedLessons","sort","a","b","aLen","bLen","localeCompare","ceil","remainingWidth","hourSlot","lessonStart","lessonEnd","min","DayTimetableComponent","textOverflow","whiteSpace","getLessonsByHour","processedHourSlots","gridRows","bottom","top","fromBottom","lessonTiles","result","cellFreeSpace","gridRowStart","gridRowEnd","toString","gridRow","gridColumn","gridTemplateColumns","columnGap","gridTemplateRows","HeaderSlotComponent","lessonIdx","startOfLesson","addMinutes","TimetableHeaderComponent","hm","Date","setHours","idx","textSection","filterAlert","timetableWrapper","gridAutoFlow","rowGap","transform","loadTimetable","request","loadClasses","timetableStatus","isLoadingSchedule","timetableSize","useEffect","today","daysInCurrentWeek","eachDayOfInterval","start","startOfWeek","weekStartsOn","end","endOfWeek","from","preferredTheme","window","matchMedia","matches","console","log","computedTheme","React","useMemo","createMuiTheme","type","overrides","MuiCssBaseline","body","scrollbarWidth","scrollbarColor","bordeRadius","border","typography","caption","ThemeProvider","path","to","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","createReducer","handleAction","failure","success","action","payload","resp","scheduleReducer","combineReducers","classesReducer","themeReducer","classReducer","groupFiltersReducer","newState","meta","newGroupsForCurrentClass","persistConfig","storage","blacklist","preferencesReducer","persistCombineReducers","rootReducer","loadScheduleEpic","action$","state$","api","pipe","isActionOf","switchMap","getSchedule","concatMap","response","transformTimetableResponse","catchError","message","of","time","newFilters","forEach","cl","timeEnd","loadClassesEpic","getClasses","combineEpics","values","scheduleEpics","classesEpics","fetch","json","apis","epicMiddleware","createEpicMiddleware","dependencies","services","middlewares","enhancer","composeWithDevTools","applyMiddleware","store","createStore","run","rootEpic","persistor","persistStore","ReactDOM","render","StrictMode","CircularProgress","document","getElementById"],"mappings":"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","file":"static/js/main.4c0f18e3.chunk.js","sourcesContent":["import { Link, makeStyles, Typography } from \"@material-ui/core\";\r\nimport React, { FunctionComponent } from \"react\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    footer: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        flexShrink: 0,\r\n    },\r\n    footerText: {\r\n        paddingRight: theme.spacing(1),\r\n        float: 'right',\r\n    },\r\n}));\r\n\r\nconst PageFooterComponent: FunctionComponent = () => {\r\n    const classes = useStyles();\r\n    return <footer className={classes.footer}>\r\n        <Typography variant=\"caption\" align=\"center\" gutterBottom>\r\n            <div className={classes.footerText}>\r\n                <Link target=\"_blank\" href=\"https://github.com/Cloud11665/sabat.dev/tree/master/api\" color=\"secondary\">API rozkładu zajęć\r\n                </Link> stworzone przez <Link target=\"_blank\" href=\"https://github.com/Cloud11665\" color=\"secondary\">Cloud11665\r\n                </Link>, <Link target=\"_blank\" href=\"https://github.com/qepasa/VLO-Schedule\" color=\"secondary\">frontend\r\n                </Link>przez\r\n                <Link target=\"_blank\" href=\"https://github.com/qepasa\" color=\"secondary\">qepasa\r\n                </Link>\r\n            </div>\r\n        </Typography>\r\n    </footer>;\r\n};\r\n\r\nexport default PageFooterComponent;\r\n","import { Lesson } from \"ApiModel\";\r\nimport { createAction } from \"typesafe-actions\";\r\n\r\nexport const setTheme = createAction('SET_THEME')<string>();\r\n\r\nexport const setClass = createAction('SET_CLASS')<string>();\r\n\r\nexport const addGroup = createAction('ADD_GROUP')<Lesson, string>();\r\n\r\nexport const removeGroup = createAction('REMOVE_GROUP')<Lesson, string>();","import { RootState } from \"typesafe-actions\";\r\nimport { getFiltersForCurrentClass as preferencesGetFilters } from \"./preferences/selectors\";\r\nimport { getTimetableSize as scheduleGetTimetableSize, filteredTimetable as scheduleFilteredTimetable } from \"./schedule/selectors\";\r\n\r\nexport const getFiltersForCurrentClass = (state: RootState) => preferencesGetFilters(state.preferences);\r\n\r\nexport const getTimetableSize = (state: RootState) => scheduleGetTimetableSize(state.schedule);\r\n\r\nexport const filteredTimetable = (state: RootState) => scheduleFilteredTimetable(state.schedule, state.preferences.groupFilters[state.preferences.class]);","import { PreferencesState } from './reducer';\r\n\r\nexport const getFiltersForCurrentClass = (state: PreferencesState) => state.groupFilters[state.class];","import { filter } from 'rxjs/operators';\r\nimport { GroupFilter, WeekSchedule } from 'ApiModel';\r\nimport { ScheduleState } from './reducer';\r\n\r\nexport const getSchedule = (state: ScheduleState) => state.schedule;\r\n\r\nexport const getTimetableSize = (state: ScheduleState) => state.schedule.flat().flat().length;\r\n\r\nexport const filteredTimetable = (state: ScheduleState, groupFilters: GroupFilter) => {\r\n    const timetable = state.schedule;\r\n\r\n    if (timetable.length === 0) return [];\r\n    if(groupFilters === undefined) return timetable;\r\n\r\n    const filteredTimetable: WeekSchedule = JSON.parse(JSON.stringify(timetable));\r\n    for (let dayIdx = 0; dayIdx < filteredTimetable.length; ++dayIdx) {\r\n        for (let hourIdx = 0; hourIdx < filteredTimetable[dayIdx].length; ++hourIdx) {\r\n            const xd = filteredTimetable[dayIdx][hourIdx].filter(lesson =>\r\n                (groupFilters[lesson.subject] === undefined) ||\r\n                (lesson.group === \"\") ||\r\n                (groupFilters[lesson.subject] !== undefined && groupFilters[lesson.subject].find(v => v.group === lesson.group) !== undefined)\r\n            );\r\n            filteredTimetable[dayIdx][hourIdx] = xd;\r\n        }\r\n    }\r\n    return filteredTimetable;\r\n}","import { Button, Checkbox, createStyles, List, ListItem, ListItemIcon, ListItemText, ListSubheader, makeStyles, Theme, Typography } from \"@material-ui/core\";\r\nimport React, { FunctionComponent, memo } from \"react\";\r\nimport { RootState } from \"typesafe-actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { Lesson } from \"ApiModel\";\r\nimport { addGroup, removeGroup } from \"../../store/preferences/actions\";\r\nimport { getFiltersForCurrentClass } from \"../../store/root-selectors\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            width: '100%',\r\n            // minWidth: '30vw',\r\n            backgroundColor: theme.palette.background.paper,\r\n            // minHeight: '10vh',\r\n            // maxHeight: '70vh',\r\n            height: 'inherit',\r\n            overflow: 'auto',\r\n        },\r\n        listSection: {\r\n            backgroundColor: 'inherit',\r\n        },\r\n        ul: {\r\n            backgroundColor: 'inherit',\r\n            padding: 0,\r\n        },\r\n    }));\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n    groups: state.schedule.groups,\r\n    selectedGroups: getFiltersForCurrentClass(state),\r\n    currentClass: state.preferences.class,\r\n});\r\n\r\nconst dispatchProps = {\r\n    addGroup: addGroup,\r\n    removeGroup: removeGroup,\r\n};\r\n\r\ntype GroupFiltersProps = ReturnType<typeof mapStateToProps> & typeof dispatchProps;\r\n\r\nconst GroupFiltersComponent: FunctionComponent<GroupFiltersProps> = memo(({ groups, selectedGroups, currentClass, addGroup, removeGroup }) => {\r\n    const cssClasses = useStyles();\r\n\r\n    const handleToggle = (lessonName: string, lesson: Lesson) => () => {\r\n        const isActive = selectedGroups[lessonName].find(val => val.group === lesson.group) !== undefined;\r\n\r\n        if (isActive) {\r\n            removeGroup(lesson, currentClass);\r\n        } else {\r\n            addGroup(lesson, currentClass);\r\n        }\r\n    }\r\n\r\n    return <>\r\n        <Typography color=\"error\" variant=\"h6\">\r\n            Uwaga! Ta funkcjonalność jest eksperymentalna. \r\n        </Typography>\r\n        <Typography>\r\n            Upewnij się, że plan lekcji po zastosowaniu filtrów wygląda tak jak się spodziewasz.\r\n        </Typography>\r\n        <List subheader={<li />} className={cssClasses.root}>\r\n            {Object.keys(groups).map(lessonName =>\r\n                <li key={`section-${lessonName}`} className={cssClasses.listSection}>\r\n                    <ul className={cssClasses.ul}>\r\n                        <ListSubheader>{lessonName}</ListSubheader>\r\n                        {groups[lessonName].map(lesson =>\r\n                            <ListItem key={`item-${lessonName}-${lesson.group}`} dense button onClick={handleToggle(lessonName, lesson)}>\r\n                                <ListItemIcon>\r\n                                    <Checkbox\r\n                                        edge=\"start\"\r\n                                        checked={selectedGroups[lessonName].find(val => val.group === lesson.group) !== undefined}\r\n                                        tabIndex={-1}\r\n                                        disableRipple\r\n                                    />\r\n                                </ListItemIcon>\r\n                                <ListItemText primary={lesson.group} secondary={`Nauczyciel: ${lesson.teacher}`} />\r\n                            </ListItem>\r\n                        )}\r\n                    </ul>\r\n                </li>\r\n            )}\r\n        </List>\r\n    </>;\r\n});\r\n\r\nexport default connect(mapStateToProps, dispatchProps)(GroupFiltersComponent);","import { Box, Button, createStyles, Dialog, DialogActions, DialogContent, DialogTitle, makeStyles, Tab, Tabs, Theme, Typography } from \"@material-ui/core\";\r\nimport { TabContext, TabList, TabPanel } from \"@material-ui/lab\";\r\nimport React, { FunctionComponent, useState } from \"react\";\r\nimport GroupFiltersComponent from \"./GroupFiltersComponent\";\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n    createStyles({\r\n        root: {\r\n            minHeight: '50vh',\r\n            maxHeight: '90vh',\r\n        },\r\n    }));\r\n\r\ntype SettingsDialogOwnProps = {\r\n    open: boolean;\r\n    onClose: () => void;\r\n};\r\n\r\ntype SettingsDialogProps = SettingsDialogOwnProps;\r\n\r\nconst SettingsDialogComponent: FunctionComponent<SettingsDialogProps> = ({ open, onClose }) => {\r\n    const cssClasses = useStyles();\r\n    const [value, setValue] = useState('1');\r\n\r\n    const handleChange = (event: React.ChangeEvent<{}>, newValue: string) => {\r\n        setValue(newValue);\r\n    };\r\n\r\n    return <Dialog open={open} onClose={onClose} aria-labelledby=\"settings-dialog\" className={cssClasses.root} maxWidth=\"md\" fullWidth>\r\n        <DialogTitle id=\"settings-dialog-title\">Ustawienia</DialogTitle>\r\n        <TabContext value={value} >\r\n            <TabList\r\n                indicatorColor=\"secondary\"\r\n                textColor=\"secondary\"\r\n                onChange={handleChange}\r\n            >\r\n                <Tab label=\"Filtry grup\" textColor=\"secondary\" value=\"1\"></Tab>\r\n            </TabList>\r\n            <DialogContent>\r\n                <TabPanel value=\"1\" >\r\n                    <GroupFiltersComponent />\r\n                </TabPanel>\r\n            </DialogContent>\r\n        </TabContext>\r\n        <DialogActions>\r\n            <Button onClick={onClose} color=\"secondary\">Zamknij</Button>\r\n        </DialogActions>\r\n    </Dialog>;\r\n};\r\n\r\nexport default SettingsDialogComponent;","import { Box, Button, IconButton, makeStyles, Menu, MenuItem, Toolbar, Tooltip, Typography } from \"@material-ui/core\";\r\nimport React, { FunctionComponent, useState } from \"react\";\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport { RouteComponentProps, useParams, withRouter } from \"react-router-dom\";\r\nimport SchoolIcon from '@material-ui/icons/School';\r\nimport { RootState } from \"typesafe-actions\";\r\nimport { connect } from \"react-redux\";\r\nimport MailIcon from '@material-ui/icons/Mail';\r\nimport GitHubIcon from '@material-ui/icons/GitHub';\r\nimport { setTheme } from \"../store/preferences/actions\";\r\nimport NightsStayIcon from '@material-ui/icons/NightsStay';\r\nimport WbSunnyIcon from '@material-ui/icons/WbSunny';\r\nimport { ClassesStatus } from \"ApiModel\";\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport SettingsDialogComponent from \"./settings/SettingsDialogComponent\";\r\n\r\nconst getThemeIcon = (theme: string, themeClicked: () => void) => {\r\n    if (theme === 'light') {\r\n        return <IconButton aria-label=\"theme-button\" color=\"inherit\" onClick={themeClicked}>\r\n            < NightsStayIcon />\r\n        </IconButton>;\r\n    } else {\r\n        return <IconButton aria-label=\"theme-button\" color=\"inherit\" onClick={themeClicked}>\r\n            < WbSunnyIcon />\r\n        </IconButton>;\r\n    }\r\n}\r\n\r\nconst getClassesMenuContent = (\r\n    availableClasses: string[], classesStatus: ClassesStatus, menuItemClicked: (c: string) => (() => void), classParam: string, skeletonStyle: string,\r\n) => {\r\n    if (classesStatus.loading) {\r\n        return <>\r\n            <Skeleton width=\"3vw\" className={skeletonStyle} animation=\"wave\" />\r\n            <Skeleton width=\"3vw\" className={skeletonStyle} animation=\"wave\" />\r\n            <Skeleton width=\"3vw\" className={skeletonStyle} animation=\"wave\" />\r\n        </>\r\n    } else if (classesStatus.error) {\r\n        return <div>\r\n            <ErrorIcon color=\"error\" />\r\n            <Typography variant=\"caption\" color=\"error\">\r\n                Wystąpił błąd podczas ładowania klas. Odśwież stronę.\r\n            </Typography>\r\n        </div>\r\n    }\r\n    return <div>\r\n        {availableClasses.map(cla => <MenuItem key={cla} onClick={menuItemClicked(cla)} selected={cla === classParam}>{cla}</MenuItem>)}\r\n    </div>;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    toolbar: {\r\n        borderBottom: `1px solid ${theme.palette.divider}`,\r\n    },\r\n    toolbarTitle: {\r\n        margin: theme.spacing(1),\r\n        flex: 1,\r\n        [theme.breakpoints.down('md')]: {\r\n            fontSize: '125%',\r\n        }\r\n    },\r\n    sectionDesktop: {\r\n        display: 'none',\r\n        [theme.breakpoints.up('md')]: {\r\n            display: 'flex',\r\n        },\r\n    },\r\n    sectionMobile: {\r\n        display: 'flex',\r\n        [theme.breakpoints.up('md')]: {\r\n            display: 'none',\r\n        },\r\n    },\r\n    skeletonStyle: {\r\n        margin: theme.spacing(1),\r\n    }\r\n}));\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n    availableClasses: state.classes.classes,\r\n    classesStatus: state.classes.isLoadingClasses,\r\n    preferences: state.preferences\r\n});\r\n\r\nconst dispatchProps = {\r\n    setTheme: setTheme,\r\n};\r\n\r\ntype PageHeaderProps = ReturnType<typeof mapStateToProps> & typeof dispatchProps & RouteComponentProps;\r\n\r\ntype HeaderParams = {\r\n    classParam: string,\r\n};\r\n\r\nconst PageHeaderComponent: FunctionComponent<PageHeaderProps> = ({ availableClasses, classesStatus, preferences, setTheme, history }) => {\r\n    const cssStyleClasses = useStyles();\r\n    const classParam = useParams<HeaderParams>().classParam;\r\n    const [selectClassAnchorEl, setSelectClassAnchorEl] = useState<null | HTMLElement>(null);\r\n    const [mobileMoreAnchorEl, setMobileMoreAnchorEl] = useState<null | HTMLElement>(null);\r\n    const [settingsOpen, setSettingsOpen] = useState<boolean>(false);\r\n\r\n    const selectClassOpen = Boolean(selectClassAnchorEl);\r\n    const mobileOpen = Boolean(mobileMoreAnchorEl);\r\n\r\n    const handleSelectClassClick = (event: React.MouseEvent<HTMLElement>) => {\r\n        setSelectClassAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleSelectClassClose = () => {\r\n        setSelectClassAnchorEl(null);\r\n    };\r\n\r\n    const selectClassMenuItemClicked = (cla: string) => (() => {\r\n        handleSelectClassClose();\r\n        history.push(`${cla}`);\r\n    });\r\n\r\n    const themeClicked = () => {\r\n        if (preferences.theme === \"dark\") {\r\n            setTheme(\"light\")\r\n        } else {\r\n            setTheme(\"dark\");\r\n        }\r\n    }\r\n\r\n    const handleMobileMenuClose = () => {\r\n        setMobileMoreAnchorEl(null);\r\n    }\r\n    const mobileMenuId = 'primary-search-account-menu-mobile';\r\n    const handleMobileMenuOpen = (event: React.MouseEvent<HTMLElement>) => {\r\n        setMobileMoreAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleSettingsOpen = () => {\r\n        setSettingsOpen(true);\r\n    };\r\n\r\n    const handleSettingsClose = () => {\r\n        setSettingsOpen(false);\r\n    };\r\n\r\n    const themeIcon = getThemeIcon(preferences.theme, themeClicked);\r\n    const feedbackIcon = (\r\n        <Tooltip title={\"Wyślij do nas maila!\"} aria-label={\"send-feedback-tooltip\"} arrow>\r\n            <IconButton aria-label=\"send-feedback\" color=\"inherit\" component=\"a\" href=\"mailto:feedback.vlorocks@gmail.com?subject=Zg%C5%82o%C5%9B%20B%C5%82%C4%85d\" target=\"_blank\">\r\n                <MailIcon />\r\n            </IconButton>\r\n        </Tooltip>);\r\n    const githubIcon = (\r\n        <Tooltip title={\"Kod na Githubie\"} aria-label={\"github-repo-tooltip\"} arrow>\r\n            <IconButton aria-label=\"github-repo\" color=\"inherit\" component=\"a\" href=\"https://github.com/qepasa/VLO-Schedule\" target=\"_blank\">\r\n                <GitHubIcon />\r\n            </IconButton>\r\n        </Tooltip>);\r\n    const settingsIcon = (\r\n        <>\r\n            <IconButton aria-label=\"settings-button\" color=\"inherit\" onClick={handleSettingsOpen}>\r\n                <SettingsIcon />\r\n            </IconButton>\r\n            <SettingsDialogComponent open={settingsOpen} onClose={handleSettingsClose} />\r\n        </>\r\n    );\r\n\r\n    const renderMobileMenu = (\r\n        <Menu\r\n            anchorEl={mobileMoreAnchorEl}\r\n            anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n            id={mobileMenuId}\r\n            keepMounted\r\n            transformOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n            open={mobileOpen}\r\n            onClose={handleMobileMenuClose}\r\n        >\r\n            <MenuItem>\r\n                {themeIcon}\r\n            </MenuItem>\r\n            <MenuItem>\r\n                {settingsIcon}\r\n            </MenuItem>\r\n            <MenuItem>\r\n                {feedbackIcon}\r\n            </MenuItem>\r\n            <MenuItem>\r\n                {githubIcon}\r\n            </MenuItem>\r\n        </Menu>\r\n    );\r\n\r\n\r\n    return <Toolbar className={cssStyleClasses.toolbar}>\r\n        <Box alignSelf=\"left\">\r\n            <Button\r\n                className={cssStyleClasses.sectionDesktop}\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                onClick={handleSelectClassClick}\r\n                endIcon={<SchoolIcon />}>\r\n                Wybierz klasę\r\n            </Button>\r\n            <IconButton onClick={handleSelectClassClick} color=\"primary\" className={cssStyleClasses.sectionMobile}>\r\n                <SchoolIcon />\r\n            </IconButton>\r\n            <Menu\r\n                id=\"classes-menu\"\r\n                anchorEl={selectClassAnchorEl}\r\n                keepMounted\r\n                open={selectClassOpen}\r\n                onClose={handleSelectClassClose}\r\n                PaperProps={{\r\n                    style: {\r\n                        maxHeight: '70vh',\r\n                    }\r\n                }}>\r\n                {getClassesMenuContent(availableClasses, classesStatus, selectClassMenuItemClicked, classParam, cssStyleClasses.skeletonStyle)}\r\n            </Menu>\r\n        </Box>\r\n        <Typography\r\n            component=\"h2\"\r\n            variant=\"h5\"\r\n            color=\"inherit\"\r\n            align=\"center\"\r\n            noWrap\r\n            className={cssStyleClasses.toolbarTitle}\r\n        >\r\n            Rozkład klasy {classParam}\r\n        </Typography>\r\n        <div className={cssStyleClasses.sectionDesktop}>\r\n            {themeIcon}\r\n            {settingsIcon}\r\n            {feedbackIcon}\r\n            {githubIcon}\r\n        </div>\r\n        <div className={cssStyleClasses.sectionMobile}>\r\n            <IconButton\r\n                aria-label=\"show more\"\r\n                aria-controls={mobileMenuId}\r\n                aria-haspopup=\"true\"\r\n                onClick={handleMobileMenuOpen}\r\n                color=\"inherit\"\r\n            >\r\n                <MoreIcon />\r\n            </IconButton>\r\n            {renderMobileMenu}\r\n        </div>\r\n    </Toolbar >\r\n};\r\n\r\nexport default withRouter(connect(mapStateToProps, dispatchProps)(PageHeaderComponent));","import { GetClassesResponse } from \"ApiModel\";\r\nimport { createAsyncAction } from \"typesafe-actions\";\r\n\r\nexport const loadClassesAsync = createAsyncAction(\r\n    'LOAD_CLASSES_REQUEST',\r\n    'LOAD_CLASSES_SUCCESS',\r\n    'LOAD_CLASSES_FAILURE'\r\n)<undefined, GetClassesResponse, string>();","import { GetScheduleResponse, GroupFilter } from \"ApiModel\";\r\nimport { createAction, createAsyncAction } from \"typesafe-actions\";\r\n\r\nexport const loadScheduleAsync = createAsyncAction(\r\n    'LOAD_SCHEDULE_REQUEST',\r\n    'LOAD_SCHEDULE_SUCCESS',\r\n    'LOAD_SCHEDULE_FAILURE'\r\n)<string, GetScheduleResponse, string>();\r\n\r\n\r\nexport const createGroupsAction = createAction('CREATE_GROUPS')<GroupFilter, string>();","\r\n// NOTE(pawelp): using 'number' here is okay since we're not expecting \r\n// arguments larger than sqrt(2^53-1) (Number.MAX_SAFE_INTEGER). In reality we're expecting ~thousands here at any time?\r\n\r\n\r\nfunction gcd(x: number, y: number): number {\r\n    if (y > x) {\r\n        return gcd(y, x);\r\n    }\r\n    if (y === 0) {\r\n        return x;\r\n    }\r\n    return gcd(y, x % y);\r\n}\r\n\r\nexport function lcm(an: number[]): number {\r\n    if (an.length === 0) { throw Error('You need to pass at least one number!'); }\r\n    if (an.length === 1) return an[0];\r\n    if (an.length === 2) return (an[0] * an[1]) / gcd(an[0], an[1]);\r\n\r\n    const last = an.pop();\r\n    const lcm_rec = lcm(an);\r\n    return (last! * lcm_rec) / gcd(last!, lcm_rec);\r\n}\r\n\r\n\r\n\r\n/*!\r\n * Get the contrasting color for any hex color\r\n * (c) 2019 Chris Ferdinandi, MIT License, https://gomakethings.com\r\n * Derived from work by Brian Suda, https://24ways.org/2010/calculating-color-contrast/\r\n * @param  {String} A hexcolor value\r\n * @return {String} The contrasting color (black or white)\r\n */\r\nexport function getContrast (hexcolor: string){\r\n\r\n\t// If a leading # is provided, remove it\r\n\tif (hexcolor.slice(0, 1) === '#') {\r\n\t\thexcolor = hexcolor.slice(1);\r\n\t}\r\n\r\n\t// If a three-character hexcode, make six-character\r\n\tif (hexcolor.length === 3) {\r\n\t\thexcolor = hexcolor.split('').map(function (hex) {\r\n\t\t\treturn hex + hex;\r\n\t\t}).join('');\r\n\t}\r\n\r\n\t// Convert to RGB value\r\n\tvar r = parseInt(hexcolor.substr(0,2),16);\r\n\tvar g = parseInt(hexcolor.substr(2,2),16);\r\n\tvar b = parseInt(hexcolor.substr(4,2),16);\r\n\r\n\t// Get YIQ ratio\r\n\tvar yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;\r\n\r\n\t// Check contrast\r\n\treturn (yiq >= 70) ? 'black' : 'white';\r\n};","\r\nexport function capitalizeFirstLetter(s: string, locale = navigator.language) {\r\n  return s.charAt(0).toLocaleUpperCase(locale) + s.slice(1);\r\n}","import React, { FunctionComponent, memo } from \"react\";\r\nimport { Lesson } from 'ApiModel';\r\nimport { Button, CssBaseline, Dialog, DialogActions, DialogContent, DialogTitle, Divider, List, ListItem, ListItemText, Typography } from \"@material-ui/core\";\r\nimport { pl } from \"date-fns/locale\";\r\nimport { format } from \"date-fns\";\r\nimport { capitalizeFirstLetter } from \"../../../utils/string-uitls\";\r\n\r\ntype HourDialogComponentOwnProps = {\r\n    lessons: Lesson[];\r\n    lessonNumber: number;\r\n    dayIndex: number,\r\n    onClose: (() => void);\r\n    open: boolean;\r\n    currentWeekInterval: Date[];\r\n};\r\n\r\ntype HourDialogComponentProps = HourDialogComponentOwnProps;\r\n\r\nconst HourDialogComponent: FunctionComponent<HourDialogComponentProps> = memo(({ lessons, lessonNumber, dayIndex, onClose, open, currentWeekInterval }) => {\r\n    if (!lessons) {\r\n        return <div></div>;\r\n    }\r\n    const handleClose = () => {\r\n        onClose();\r\n    };\r\n    return <>\r\n        <CssBaseline />\r\n        <Dialog onClose={handleClose} aria-labelledby=\"lessons-list-dialog\" open={open} fullWidth>\r\n            <DialogTitle id=\"lessons-list-dialog-title\">\r\n                {capitalizeFirstLetter(format(currentWeekInterval[dayIndex], \"cccc\", { locale: pl }))} - lekcja {lessonNumber}\r\n            </DialogTitle>\r\n            <DialogContent>\r\n                <List>\r\n                    {lessons.map(lesson => {\r\n                        const key = lesson.subject + lesson.teacher + lesson.color + lesson.group;\r\n                        return (<>\r\n                            <ListItem key={key}>\r\n                                <ListItemText\r\n                                    primary={`${lesson.subject}${lesson.group ? \" - \" + lesson.group : \"\"}`}\r\n                                    secondary={<>\r\n                                        <Typography component=\"a\" variant=\"body2\" key={key+\"Teacher\"}>Nauczyciel: {lesson.teacher}</Typography>\r\n                                        <br />\r\n                                        <Typography component=\"a\" variant=\"body2\" key={key+\"Classroom\"}>Sala: {lesson.classroom}</Typography>\r\n                                    </>}\r\n                                    key={key+\"ListItemText\"}\r\n                                />\r\n                            </ListItem>\r\n                            <Divider variant=\"middle\" component=\"li\" key={key+\"Divider\"} />\r\n                        </>)\r\n                    })}\r\n                </List>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={handleClose} color=\"secondary\">Zamknij</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    </>\r\n});\r\n\r\nexport default HourDialogComponent;","import { makeStyles } from '@material-ui/core';\r\nimport { Lesson } from 'ApiModel';\r\nimport React, { FunctionComponent, memo, useState } from 'react';\r\nimport useFitText from 'use-fit-text';\r\nimport HourDialogComponent from './HourDialogComponent';\r\nimport { getContrast } from '../../../utils/math-utils';\r\n\r\ntype LessonComponentOwnProps = {\r\n    lesson: Lesson;\r\n    height: string;\r\n    lessonsByHour: Lesson[][];\r\n    currentWeekInterval: Date[];\r\n};\r\n\r\ntype LessonComponentProps = LessonComponentOwnProps;\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    lessonTile: {\r\n        padding: theme.spacing(0.2),\r\n    },\r\n    textStyle: {\r\n        // NOTE(pawelp): fiddle with this if you want to make text colors fancy\r\n        // filter: 'invert(5%) contrast(200%) grayscale(170%) saturate(0%)'\r\n    }\r\n}));\r\n\r\nconst LessonComponent: FunctionComponent<LessonComponentProps> = memo(({ lesson, height, lessonsByHour, currentWeekInterval }) => {\r\n    const cssStyleClasses = useStyles();\r\n    const { fontSize, ref } = useFitText({logLevel: \"none\", minFontSize: 5});\r\n    const [open, setOpen] = useState(false);\r\n    const [dialogData, setDialogData] = useState<Lesson[]>([]);\r\n    const [lessonNumber, setLessonNumber] = useState<number>(0);\r\n\r\n    const handleClose = () => {\r\n        setOpen(false);\r\n    }\r\n\r\n    const handleClick = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\r\n        let currentTargetRect = e.currentTarget.getBoundingClientRect();\r\n        const clickXPosRelative = e.pageX - currentTargetRect.left;\r\n        const clickPositionFrac = clickXPosRelative / (currentTargetRect.right - currentTargetRect.left);\r\n        const lessonDurationFrac = 1 / lesson.duration;\r\n        const clickedPart = Math.floor(clickPositionFrac / lessonDurationFrac);\r\n\r\n        if (e.target === ref.current ||\r\n            (e.target instanceof Node && ref.current.contains(e.target))) {\r\n            setDialogData(lessonsByHour[lesson.time_index + clickedPart]);\r\n            setLessonNumber(lesson.time_index + clickedPart);\r\n            setOpen(true);\r\n        }\r\n    }\r\n    const textColor = getContrast(lesson.color);\r\n\r\n    return <div style={{\r\n        fontSize, height: height, overflow: 'hidden', display: 'flex', flexDirection: 'column'\r\n    }} ref={ref} onClick={handleClick} className={cssStyleClasses.lessonTile}>\r\n        <div style={{\r\n            textAlign: 'left', flex: \"1 0 auto\", color: textColor,\r\n        }} className={cssStyleClasses.textStyle}>{lesson.teacher}</div>\r\n        <div style={{ textAlign: 'center', flex: \"1 0 auto\", color: textColor }} className={cssStyleClasses.textStyle}>{lesson.subject}</div>\r\n        <div style={{ flexShrink: 0, color: textColor }} className={cssStyleClasses.textStyle}>\r\n            <div style={{ float: 'left', textAlign: 'left' }}>{lesson.classroom}</div>\r\n            <div style={{ float: 'right', textAlign: 'right' }}>{lesson.group}</div>\r\n        </div>\r\n        <HourDialogComponent lessons={dialogData} lessonNumber={lessonNumber} dayIndex={lesson.day_index} onClose={handleClose} open={open} currentWeekInterval={currentWeekInterval}/>\r\n    </div>;\r\n});\r\n\r\nexport default LessonComponent;","import React, { FunctionComponent } from \"react\";\r\nimport { DaySchedule, Lesson } from 'ApiModel';\r\nimport { format } from \"date-fns\";\r\nimport { lcm } from \"../../../utils/math-utils\";\r\nimport LessonComponent from \"../hourTimetable/LessonComponent\";\r\nimport { pl } from \"date-fns/locale\";\r\n\r\ntype PositionData = {\r\n    width: number,\r\n};\r\n\r\ntype ProcessedLesson = Lesson & PositionData;\r\n\r\ntype ProcessedHourSlot = {\r\n    lessons: Array<ProcessedLesson>; // lessons that start at current slot. Sorted by (time_index+duration, subject) descending.\r\n    totalWidth: number;\r\n    ceil: number;\r\n    floor: number;\r\n}\r\n\r\ntype CellPositionData = {\r\n    top: number;\r\n    bottom: number;\r\n}\r\n\r\nfunction getLessonsByHour(dayTimetable: DaySchedule) {\r\n    const lessonsByHour = [...Array(11)].map(() => Array<Lesson>());\r\n\r\n    dayTimetable.flat().map(lesson => {\r\n        for (let i = 0; i < lesson.duration; i++) {\r\n            lessonsByHour[lesson.time_index + i].push(lesson);\r\n        }\r\n    });\r\n    return lessonsByHour;\r\n}\r\n\r\n\r\nfunction getProcessedHourSlots(dayTimetable: DaySchedule, lessonsByHour: Lesson[][]): Array<ProcessedHourSlot> {\r\n    const maxCongetsion = Array(11).fill(0);\r\n    for (let i = 0; i < 11; ++i) {\r\n        maxCongetsion[i] = lessonsByHour[i].length;\r\n    }\r\n\r\n    const totalWidth = lcm(maxCongetsion.filter(val => val !== 0));\r\n\r\n    const processedHourSlot = dayTimetable.map(hourSchedule => {\r\n        const processedLessons = hourSchedule.map(lesson => { return lesson as ProcessedLesson });\r\n\r\n        processedLessons.sort((a, b) => {\r\n            const aLen = a.time_index + a.duration - 1;\r\n            const bLen = b.time_index + b.duration - 1;\r\n            if (aLen === bLen) {\r\n                return a.subject.localeCompare(b.subject);\r\n            }\r\n            return aLen > bLen ? -1 : 1;\r\n        });\r\n        return {\r\n            lessons: processedLessons,\r\n            totalWidth: totalWidth,\r\n            ceil: totalWidth,\r\n            floor: 0,\r\n        } as ProcessedHourSlot;\r\n    });\r\n    const remainingWidth = Array(11).fill(totalWidth);\r\n    /// calculate remaining width for each slot individually!!!!\r\n    for (const hourSlot of processedHourSlot) {\r\n        for (const lesson of hourSlot.lessons) {\r\n            const lessonStart = lesson.time_index, lessonEnd = lesson.time_index + lesson.duration;\r\n            let width = totalWidth + 1;\r\n            for (let i = lessonStart; i < lessonEnd; ++i) {\r\n                width = Math.min(width, Math.floor(remainingWidth[i] / maxCongetsion[i]));\r\n            }\r\n            lesson.width = width;\r\n            for (let i = lessonStart; i < lessonEnd; ++i) {\r\n                maxCongetsion[i]--;\r\n                remainingWidth[i] -= width;\r\n            }\r\n        }\r\n    }\r\n\r\n    return processedHourSlot;\r\n}\r\n\r\ntype DayTimetableOwnProps = {\r\n    dayTimetable: DaySchedule;\r\n    dayIdx: number;\r\n    currentWeekInterval: Date[];\r\n};\r\n\r\ntype DayTimetableProps = DayTimetableOwnProps;\r\n\r\nconst DayTimetableComponent: FunctionComponent<DayTimetableProps> = ({ dayTimetable, dayIdx, currentWeekInterval }) => {\r\n    if (!dayTimetable || dayTimetable.length === 0) {\r\n        return <>\r\n            <div style={{ textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap' }}>\r\n                {format(currentWeekInterval[dayIdx], \"iii\", { locale: pl })}\r\n            </div>\r\n            <div></div>\r\n        </>;\r\n    }\r\n\r\n    const lessonsByHour = getLessonsByHour(dayTimetable);\r\n    const processedHourSlots = getProcessedHourSlots(dayTimetable, lessonsByHour);\r\n\r\n    const gridRows = processedHourSlots.length > 0 ? processedHourSlots[0].totalWidth : 1;\r\n\r\n    const remainingWidth = Array<CellPositionData>(11);\r\n    for (let i = 0; i < 11; ++i) {\r\n        remainingWidth[i] = {\r\n            bottom: 1,\r\n            top: gridRows + 1,\r\n        };\r\n    }\r\n    let fromBottom: boolean = true;\r\n\r\n    const lessonTiles = processedHourSlots.map(hourSlot => {\r\n        const result = [];\r\n        for (const lesson of hourSlot.lessons) {\r\n\r\n            let cellFreeSpace = remainingWidth[lesson.time_index];\r\n            let gridRowStart, gridRowEnd;\r\n            if (fromBottom) {\r\n                gridRowStart = cellFreeSpace.bottom;\r\n                gridRowEnd = cellFreeSpace.bottom + lesson.width;\r\n            } else {\r\n                gridRowEnd = cellFreeSpace.top;\r\n                gridRowStart = cellFreeSpace.top - lesson.width;\r\n            }\r\n\r\n            const key = lesson.day_index.toString() + lesson.time_index.toString() + lesson.classroom.toString() + lesson.subject + lesson.teacher + lesson.group;\r\n\r\n            result.push(<div style={\r\n                {\r\n                    backgroundColor: `${lesson.color}`,\r\n                    gridRow: `${gridRowStart.toString()} / ${gridRowEnd.toString()}`,\r\n                    gridColumn: `${(lesson.time_index + 1).toString()} / ${(lesson.time_index + lesson.duration + 1).toString()}`,\r\n\r\n                }} key={key}>\r\n                <LessonComponent lesson={lesson} height={(15 * lesson.width / gridRows) + 'vh'} lessonsByHour={lessonsByHour} currentWeekInterval={currentWeekInterval} />\r\n            </div>);\r\n            for (let i = lesson.time_index; i < lesson.time_index + lesson.duration; i++) {\r\n                if (fromBottom) {\r\n                    remainingWidth[i].bottom = gridRowEnd;\r\n                } else {\r\n                    remainingWidth[i].top = gridRowStart;\r\n                }\r\n            }\r\n\r\n            fromBottom = !fromBottom;\r\n        }\r\n        return result;\r\n    })\r\n    return <>\r\n        <div style={{ textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap' }}>\r\n            {format(currentWeekInterval[dayIdx], \"iii\", { locale: pl })}\r\n        </div>\r\n        <div style={{ display: 'grid', gridTemplateColumns: `repeat(11, calc(90vw/11))`, columnGap: '1px', gridTemplateRows: `repeat(${gridRows}, calc(15vh/${gridRows}))` }}>\r\n            {lessonTiles.flat()}\r\n        </div>\r\n    </>;\r\n};\r\n\r\nexport default DayTimetableComponent;\r\n","import { Box } from \"@material-ui/core\";\r\nimport { addMinutes, format } from \"date-fns\";\r\nimport React, { FunctionComponent } from \"react\";\r\nimport useFitText from \"use-fit-text\";\r\n\r\ntype HeaderSlotComponentProps = {\r\n    lessonIdx: number;\r\n    startOfLesson: number;\r\n}\r\n\r\nconst HeaderSlotComponent: FunctionComponent<HeaderSlotComponentProps> = ({ lessonIdx, startOfLesson }) => {\r\n    const { fontSize, ref } = useFitText();\r\n    return <Box height=\"5vh\" overflow=\"hidden\" whiteSpace=\"nowrap\" textOverflow=\"elipsis\">\r\n        <div style={{ fontSize }} ref={ref}>\r\n            <div>{lessonIdx.toString()}</div>\r\n            <div>{format(startOfLesson, \"HH:mm\") + \"-\" + format(addMinutes(startOfLesson, 45), \"HH:mm\")}</div>\r\n        </div>\r\n    </Box>\r\n}\r\n\r\n\r\nexport default HeaderSlotComponent;","import React, { FunctionComponent, memo } from \"react\";\r\nimport HeaderSlotComponent from \"./HeaderSlotComponent\";\r\n\r\n\r\ntype TimetableHeaderOwnProps = {\r\n};\r\n\r\nconst TimetableHeaderComponent: FunctionComponent<TimetableHeaderOwnProps> = memo(() => {\r\n    // todo(pawelp): this is ugly. Probably should extract this data somewhere else (e.g. to redux).\r\n    const startOfLessonArray = [\r\n        '7:10', '8:00', '9:00', '10:00', '11:00', '12:00', '13:00', '14:00', '14:50', '15:40', '16:30',\r\n    ];\r\n    return <>\r\n        <div></div>\r\n        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(11, calc(90vw/11))', columnGap: '1px' }}>\r\n            {startOfLessonArray.map(startOfLesson => {\r\n                const hm = startOfLesson.split(':');\r\n                return new Date().setHours(parseInt(hm[0]), parseInt(hm[1]));\r\n            }).map((startOfLesson, idx) => <HeaderSlotComponent lessonIdx={idx} startOfLesson={startOfLesson} key={startOfLesson.toString()+idx.toString()}/>)}\r\n        </div>\r\n    </>;\r\n});\r\n\r\n\r\nexport default TimetableHeaderComponent;","import { Box, makeStyles, Snackbar, Typography } from \"@material-ui/core\";\r\nimport { eachDayOfInterval, format } from \"date-fns\";\r\nimport { endOfWeek, startOfWeek } from \"date-fns/esm\";\r\nimport React, { FunctionComponent, useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { RootState } from \"typesafe-actions\";\r\nimport { loadClassesAsync } from \"../../store/classes/actions\";\r\nimport { loadScheduleAsync } from \"../../store/schedule/actions\";\r\nimport DayTimetableComponent from \"./dayTimetable/DayTimetableComponent\";\r\nimport TimetableHeaderComponent from \"./timetableHeader/TimetableHeaderComponent\";\r\nimport Skeleton from '@material-ui/lab/Skeleton';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport { setClass } from \"../../store/preferences/actions\";\r\nimport { pl } from \"date-fns/locale\";\r\nimport { filteredTimetable, getTimetableSize } from \"../../store/root-selectors\";\r\nimport { Alert } from \"@material-ui/lab\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    textSection: {\r\n        height: '4vh',\r\n    },\r\n    filterAlert: {\r\n        width: '30vw',\r\n        overflow: 'hidden',\r\n        whiteSpace: 'nowrap',\r\n        textOverflow: 'elipsis',\r\n        height: 'inherit',\r\n    },\r\n    timetableWrapper: {\r\n        display: 'grid',\r\n        gridAutoFlow: 'rows',\r\n        gridTemplateColumns: '7vw 90vw',\r\n        gridTemplateRows: '5vh repeat(5, 15vh)',\r\n        rowGap: '1px',\r\n        margin: theme.spacing(2, 1, 2, 1),\r\n    },\r\n    skeletonStyle: {\r\n        transform: 'scale(1, 0.95)',\r\n        gridColumn: '2 / 3',\r\n    },\r\n}));\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n    timetableStatus: state.schedule.isLoadingSchedule,\r\n    timetable: state.schedule.schedule,\r\n    timetableSize: getTimetableSize(state),\r\n    filteredTimetable: filteredTimetable(state),\r\n});\r\n\r\nconst dispatchProps = {\r\n    loadTimetable: loadScheduleAsync.request,\r\n    loadClasses: loadClassesAsync.request,\r\n    setClass: setClass,\r\n}\r\n\r\ntype ScheduleParams = {\r\n    classParam: string,\r\n}\r\n\r\ntype ScheduleProps = ReturnType<typeof mapStateToProps> & typeof dispatchProps;\r\n\r\nconst TimetableComponent: FunctionComponent<ScheduleProps> = ({ timetableStatus, timetable, timetableSize, filteredTimetable, loadTimetable, loadClasses, setClass }) => {\r\n    const cssStyleClasses = useStyles();\r\n    const classParam = useParams<ScheduleParams>().classParam;\r\n    // NOTE(pawelp): not sure if this guarantees that class will be set\r\n    // **before** we dispatch `loadTimetable`. If any errors occur we could create\r\n    // epic for `setClass` that triggers loadTimetable. For now \r\n    useEffect(() => { setClass(classParam); }, [setClass, classParam]);\r\n    useEffect(() => { loadClasses(); }, [loadClasses]);\r\n    useEffect(() => { loadTimetable(classParam); }, [loadTimetable, classParam]);\r\n\r\n    const today = new Date();\r\n    const daysInCurrentWeek: Date[] = eachDayOfInterval({\r\n        start: startOfWeek(today, { weekStartsOn: 1 }),\r\n        end: endOfWeek(today, { weekStartsOn: 1 }),\r\n    });\r\n    const filteredSize = filteredTimetable && filteredTimetable.flat().flat().length;\r\n    return <>\r\n        <Box className={cssStyleClasses.textSection}>\r\n        </Box>\r\n        <Box className={cssStyleClasses.timetableWrapper}>\r\n            <TimetableHeaderComponent />\r\n            {timetableStatus.loading\r\n                ? Array.from(Array(5).keys()).map((idx) => <>\r\n                    <div style={{ textOverflow: 'ellipsis', overflow: 'hidden', whiteSpace: 'nowrap' }}>\r\n                        {format(daysInCurrentWeek[idx], \"iii\", { locale: pl })}\r\n                    </div>\r\n                    <Skeleton className={cssStyleClasses.skeletonStyle} animation=\"wave\" key={\"skeleton\" + idx.toString()} />\r\n                </>)\r\n                : timetableStatus.error ?\r\n                    <>\r\n                        <ErrorIcon color=\"error\" />\r\n                        <Typography variant=\"h6\" color=\"error\">\r\n                            Wystąpił błąd podczas ładowania rozkładu. Odśwież stronę.\r\n                    </Typography>\r\n                    </>\r\n                    : Array.from(Array(5).keys()).map(dayIdx => <DayTimetableComponent dayTimetable={filteredTimetable[dayIdx]} dayIdx={dayIdx} currentWeekInterval={daysInCurrentWeek} key={dayIdx.toString()} />)\r\n            }\r\n        </Box>\r\n    </>;\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps, dispatchProps)(TimetableComponent);","import { createMuiTheme, CssBaseline, Theme, ThemeProvider } from \"@material-ui/core\";\r\nimport React, { FunctionComponent } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Switch,\r\n  Route,\r\n  HashRouter,\r\n  Redirect\r\n} from \"react-router-dom\";\r\nimport { RootState } from \"typesafe-actions\";\r\nimport PageFooterComponent from \"./components/PageFooterComponent\";\r\nimport PageHeaderComponent from \"./components/PageHeaderComponent\";\r\nimport TimetableComponent from \"./components/timetable/TimetableComponent\";\r\nimport { setTheme } from \"./store/preferences/actions\";\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  preferences: state.preferences\r\n});\r\n\r\nconst dispatchProps = {\r\n  setTheme: setTheme,\r\n};\r\n\r\ntype AppProps = ReturnType<typeof mapStateToProps> & typeof dispatchProps;\r\ntype ThemeType = 'dark' | 'light';\r\n\r\nconst App: FunctionComponent<AppProps> = ({ preferences, setTheme }) => {\r\n  const preferredTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\r\n  console.log(preferredTheme);\r\n  if (preferences.theme === \"\") {\r\n    setTheme(preferredTheme);\r\n  }\r\n\r\n  const computedTheme = preferences.theme === \"\" ? preferredTheme : preferences.theme;\r\n\r\n  const theme: Theme = React.useMemo(() => createMuiTheme({\r\n    palette: {\r\n      type: (computedTheme as ThemeType),\r\n    },\r\n    overrides: {\r\n      MuiCssBaseline: {\r\n        '@global': {\r\n          body: {\r\n            '-webkit-text-size-adjust': 'none',\r\n            'text-size-adjust': 'none',\r\n            '-moz-text-size-adjust': 'none',\r\n            '-ms-text-size-adjuist': 'none',\r\n          },\r\n          '*': {\r\n            '--scrollbarBG': '#CFD8DC',\r\n            '--thumbBG': '#90A4AE',\r\n            scrollbarWidth: 'thin',\r\n            scrollbarColor: 'var(--thumbBG) var(--scrollbarBG)',\r\n          },\r\n          '*::-webkit-scrollbar': {\r\n            width: '11px',\r\n          },\r\n          '*::-webkit-scrollbar-track': {\r\n            background: 'var(--scrollbarBG)',\r\n          },\r\n          '*::-webkit-scrollbar-thumb': {\r\n            backgroundColor: 'var(--thumbBG)',\r\n            bordeRadius: '6px',\r\n            border: '3px solid var(--scrollbarBG)',\r\n          },\r\n        },\r\n      },\r\n    }\r\n  }), [computedTheme]);\r\n\r\n  theme.typography.caption = {\r\n    [theme.breakpoints.down('sm')]: {\r\n      fontSize: '60%',\r\n    }\r\n  }\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <CssBaseline />\r\n      <HashRouter>\r\n        <Switch>\r\n          <Route path=\"/timetable/:classParam\">\r\n            <div style={{ display: 'flex', flexDirection: 'column', height: '100vh' }}>\r\n              <div style={{ flex: \"1 0 auto\" }}>\r\n                <PageHeaderComponent />\r\n                <TimetableComponent />\r\n              </div>\r\n              <PageFooterComponent />\r\n            </div>\r\n          </Route>\r\n          <Route path=\"/\">\r\n            <Redirect to=\"/timetable/1A\" />\r\n          </Route>\r\n        </Switch>\r\n      </HashRouter>\r\n    </ThemeProvider >\r\n  );\r\n}\r\n\r\nexport default connect(mapStateToProps, dispatchProps)(App);","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import { combineReducers } from 'redux';\r\nimport { GroupFilter, ScheduleStatus, WeekSchedule } from \"ApiModel\";\r\nimport { createReducer } from 'typesafe-actions';\r\nimport { createGroupsAction, loadScheduleAsync } from \"./actions\";\r\n\r\nexport const isLoadingSchedule = createReducer({ loading: true, error: false } as ScheduleStatus)\r\n    .handleAction(loadScheduleAsync.request, () => ({ loading: true, error: false } as ScheduleStatus))\r\n    .handleAction(loadScheduleAsync.failure, () => ({ loading: false, error: true } as ScheduleStatus))\r\n    .handleAction(loadScheduleAsync.success, (state, action) => {\r\n        return { loading: false, error: !action.payload.success } as ScheduleStatus;\r\n    });\r\n\r\nexport const schedule = createReducer([] as WeekSchedule)\r\n    .handleAction(loadScheduleAsync.success, (state, action) => action.payload.resp ? action.payload.resp : []);\r\n\r\n// TODO(pawelp): do this using selectors instead. Preferably memoized one like reselect. \r\nexport const groups = createReducer({} as GroupFilter)\r\n    .handleAction(createGroupsAction, (state, action) => {\r\n        return { ...action.payload };\r\n    });\r\n\r\nconst scheduleReducer = combineReducers({\r\n    isLoadingSchedule,\r\n    schedule,\r\n    groups,\r\n});\r\n\r\nexport default scheduleReducer;\r\nexport type ScheduleState = ReturnType<typeof scheduleReducer>;","import { loadClassesAsync } from './actions';\r\nimport { combineReducers } from 'redux';\r\nimport { ClassesStatus } from \"ApiModel\";\r\nimport { createReducer } from 'typesafe-actions';\r\n\r\nexport const isLoadingClasses = createReducer({ loading: true, error: false } as ClassesStatus)\r\n    .handleAction(loadClassesAsync.request, () => ({ loading: true, error: false } as ClassesStatus))\r\n    .handleAction(loadClassesAsync.failure, () => ({ loading: false, error: true } as ClassesStatus))\r\n    .handleAction(loadClassesAsync.success, (state, action) => {\r\n        return { loading: false, error: !action.payload.success } as ClassesStatus;\r\n    });\r\n\r\nexport const classes = createReducer([] as string[])\r\n    .handleAction(loadClassesAsync.success, (state, action) => action.payload.resp ? action.payload.resp : []);\r\n\r\nconst classesReducer = combineReducers({\r\n    isLoadingClasses,\r\n    classes,\r\n});\r\n\r\nexport default classesReducer;\r\nexport type ClassesState = ReturnType<typeof classesReducer>;","import { createGroupsAction } from './../schedule/actions';\r\nimport storage from 'redux-persist/lib/storage';\r\nimport { addGroup, removeGroup, setClass, setTheme } from './actions';\r\nimport { createReducer } from 'typesafe-actions';\r\nimport { persistCombineReducers } from 'redux-persist';\r\nimport { GroupFiltersByClass } from 'ApiModel';\r\n\r\n\r\nexport const themeReducer = createReducer('')\r\n    .handleAction(setTheme, (state, action) => {\r\n        return action.payload;\r\n    });\r\n\r\nexport const classReducer = createReducer('')\r\n    .handleAction(setClass, (state, action) => {\r\n        return action.payload;\r\n    });\r\n\r\nexport const groupFiltersReducer = createReducer({} as GroupFiltersByClass)\r\n    .handleAction(createGroupsAction, (state, action) => {\r\n        /// TODO(pawelp): this should be more clever. In particular, we'll miss groups in new show up and have groups left\r\n        // behind if some groups get removed.\r\n        const newState = state;\r\n        if (!newState[action.meta]) {\r\n            newState[action.meta] = action.payload;\r\n        }\r\n        return { ...newState };\r\n    })\r\n    .handleAction(addGroup, (state, action) => {\r\n        const newState = state;\r\n        newState[action.meta][action.payload.subject].push(action.payload);\r\n        const newGroupsForCurrentClass = newState[action.meta];\r\n        delete newState[action.meta];\r\n\r\n        return {\r\n            ...newState,\r\n            [action.meta]: {\r\n                ...newGroupsForCurrentClass,\r\n            },\r\n        };\r\n    })\r\n    .handleAction(removeGroup, (state, action) => {\r\n        const newState = state;\r\n\r\n        newState[action.meta][action.payload.subject] = newState[action.meta][action.payload.subject].filter(val => val.group !== action.payload.group);\r\n        const newGroupsForCurrentClass = newState[action.meta];\r\n        delete newState[action.meta];\r\n\r\n        return {\r\n            ...newState,\r\n            [action.meta]: {\r\n                ...newGroupsForCurrentClass,\r\n            },\r\n        };\r\n    });\r\n\r\nconst persistConfig = {\r\n    key: 'preferences',\r\n    storage,\r\n    blacklist: ['class'],\r\n}\r\n\r\nconst preferencesReducer = persistCombineReducers(persistConfig, {\r\n    theme: themeReducer,\r\n    class: classReducer,\r\n    groupFilters: groupFiltersReducer,\r\n});\r\n\r\nexport default preferencesReducer;\r\nexport type PreferencesState = ReturnType<typeof preferencesReducer>;","import scheduleReducer from './schedule/reducer';\r\nimport classesReducer from './classes/reducer';\r\nimport preferencesReducer from './preferences/reducer';\r\nimport { combineReducers } from 'redux';\r\n\r\nconst rootReducer = combineReducers({\r\n  schedule: scheduleReducer,\r\n  classes: classesReducer,\r\n  preferences: preferencesReducer,\r\n});\r\n\r\nexport default rootReducer;\r\n","import { loadScheduleAsync, createGroupsAction } from './actions';\r\nimport { Epic } from 'redux-observable';\r\nimport { RootAction, RootState, Services, isActionOf } from 'typesafe-actions';\r\nimport { from, of } from 'rxjs';\r\nimport { filter, switchMap, catchError, mergeMap, concatMap } from 'rxjs/operators';\r\nimport { GetScheduleResponse, GroupFilter } from 'ApiModel';\r\n\r\nexport const loadScheduleEpic: Epic<\r\n    RootAction,\r\n    RootAction,\r\n    RootState,\r\n    Services\r\n> = (action$, state$, { api }) => action$.pipe(\r\n    filter(isActionOf(loadScheduleAsync.request)),\r\n    switchMap((action) =>\r\n        from(api.schedule.getSchedule(action.payload)).pipe(\r\n            concatMap((response) => from([createGroupsAction(transformTimetableResponse(response), state$.value.preferences.class), loadScheduleAsync.success(response)])),\r\n            catchError((message: string) => of(loadScheduleAsync.failure(message)))\r\n        )\r\n    )\r\n);\r\n\r\n\r\nfunction transformTimetableResponse(response: GetScheduleResponse): GroupFilter {\r\n    console.time('transformTimetableResponse');\r\n    const newFilters = {} as GroupFilter;\r\n    // TODO: (pawelp) remodel handling of error so that we map `success = false` to error at service level\r\n    if (!response.success) return newFilters;\r\n\r\n    response.resp.flat().flat().forEach(cl => {\r\n        if (!newFilters[cl.subject] && cl.group !== \"\") {\r\n            newFilters[cl.subject] = [];\r\n        }\r\n        if (cl.group !== \"\" && !newFilters[cl.subject].find(lesson => lesson.group === cl.group)) {\r\n            newFilters[cl.subject].push(cl);\r\n        }\r\n    });\r\n    // Object.values(newFilters).forEach(arr => arr.sort((a, b) => a.group.localeCompare(b.group)));\r\n    console.timeEnd('transformTimetableResponse');\r\n    return newFilters;\r\n}\r\n\r\n","import { loadClassesAsync } from './actions';\r\nimport { Epic } from \"redux-observable\";\r\nimport { catchError, filter, map, switchMap } from \"rxjs/operators\";\r\nimport { isActionOf, RootAction, RootState, Services } from \"typesafe-actions\";\r\nimport { from, of } from 'rxjs';\r\n\r\nexport const loadClassesEpic: Epic<\r\n    RootAction,\r\n    RootAction,\r\n    RootState,\r\n    Services\r\n> = (action$, state$, { api }) => action$.pipe(\r\n    filter(isActionOf(loadClassesAsync.request)),\r\n    switchMap(() =>\r\n        from(api.schedule.getClasses()).pipe(\r\n            map(loadClassesAsync.success),\r\n            catchError((message: string) => of(loadClassesAsync.failure(message))\r\n            )\r\n        )\r\n    )\r\n);","import { combineEpics } from 'redux-observable';\r\n\r\nimport * as scheduleEpics from './schedule/epics';\r\nimport * as classesEpics from './classes/epics';\r\n\r\nexport default combineEpics(\r\n    ...Object.values(scheduleEpics),\r\n    ...Object.values(classesEpics),\r\n);\r\n","import { GetScheduleResponse, GetClassesResponse } from \"ApiModel\";\r\n\r\n\r\nexport function getSchedule(classParam: string): Promise<GetScheduleResponse> {\r\n    return fetch(`/api/tta?c=${classParam}`)\r\n        .then(response => response.json());\r\n}\r\n\r\nexport function getClasses(): Promise<GetClassesResponse> {\r\n    return fetch(`/api/cla`)\r\n        .then(response => response.json());\r\n}","import * as schedule from './schedule-api';\r\n\r\nconst apis = {\r\n    api: {\r\n        schedule,\r\n    },\r\n};\r\n\r\nexport default apis;","import { createStore, applyMiddleware } from 'redux';\r\nimport { createEpicMiddleware } from 'redux-observable';\r\nimport { RootAction, RootState, Services } from 'typesafe-actions';\r\n\r\nimport rootReducer from './root-reducer';\r\nimport rootEpic from './root-epic';\r\nimport services from '../services';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\n\r\nexport const epicMiddleware = createEpicMiddleware<\r\n  RootAction,\r\n  RootAction,\r\n  RootState,\r\n  Services\r\n>({\r\n  dependencies: services,\r\n});\r\n\r\n// configure middlewares\r\nconst middlewares = [epicMiddleware];\r\n// compose enhancers\r\nconst enhancer = composeWithDevTools(applyMiddleware(...middlewares));\r\n\r\n// rehydrate state on app start\r\n// const initialState = {};\r\n\r\n// create store\r\nconst store = createStore(rootReducer, enhancer);\r\nepicMiddleware.run(rootEpic);\r\n\r\n// export store singleton instance\r\nexport default store;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { Provider } from 'react-redux';\r\nimport store from './store';\r\nimport { PersistGate } from 'redux-persist/integration/react';\r\nimport { persistStore } from 'redux-persist';\r\nimport { CircularProgress } from '@material-ui/core';\r\n\r\nconst persistor = persistStore(store);\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <PersistGate loading={<CircularProgress />} persistor={persistor}>\r\n        <App />\r\n      </PersistGate>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}